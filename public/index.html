<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>PrizeGift</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
      background: #f2f2f2;
    }
    h1 {
      margin-bottom: 30px;
    }
    #start-btn {
      padding: 10px 20px;
      font-size: 18px;
      background-color: #2481cc;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    #start-btn:hover {
      background-color: #1a64a1;
    }
  </style>
</head>
<body>

  <h1>üéÆ –†—É–ª–µ—Ç–∫–∞ Telegram</h1>

  <div id="content">
    <p style="color: red;">‚ö† –ß—Ç–æ–±—ã –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è, –∑–∞–ø—É—Å—Ç–∏ –∏–≥—Ä—É —á–µ—Ä–µ–∑ Telegram</p>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();

    const user = tg.initDataUnsafe?.user;

    if (user && user.id) {
      // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–Ω–æ–ø–∫—É
      document.getElementById('content').innerHTML = `
        <p>üëã –ü—Ä–∏–≤–µ—Ç, ${user.first_name || '–¥—Ä—É–≥'}!</p>
        <button id="start-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
      `;

      // –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ backend
      fetch("http://93.183.82.218:5000/auth", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          user_id: user.id,
          username: user.username
        })
      })
      .then(res => res.json())
      .then(data => {
        console.log("‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ:", data);
      })
      .catch(err => {
        console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:", err);
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏
      document.addEventListener('click', e => {
        if (e.target.id === 'start-btn') {
          alert('üéâ –ò–≥—Ä–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è!');
        }
      });
    }
  </script>

</body>
</html>
